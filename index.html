<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Yc Store</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <style>
        /* Tailwind'in düzgün çalışması için temel stiller */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc; /* Yeni: Çok açık gri arka plan */
            color: #1a202c; /* Yeni: Koyu gri metin */
            overscroll-behavior-x: none;
        }

        /* Sayfalar arası geçiş için yardımcı class */
        .page {
            display: none; /* Sayfaları varsayılan olarak gizle */
        }
        .page.active {
            display: block; /* Aktif sayfayı göster */
        }

        /* Ürün açıklamasının taşmasını engellemek için */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;  
            overflow: hidden;
        }
        .line-clamp-1 {
            display: -webkit-box;
            -webkit-line-clamp: 1;
            -webkit-box-orient: vertical;  
            overflow: hidden;
        }

        /* Sepet ikonu üzerindeki bildirim balonu */
        .cart-badge {
            position: absolute;
            top: -8px;
            right: -10px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: #e53e3e; /* Yeni: Kırmızı */
            color: white;
            font-size: 12px;
            font-weight: 600;
        }
        
        /* Geçiş efekti */
        .page {
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Aktif kategori linki stili (Yeni Tasarım) */
        .category-link.active {
            color: #2c5282; /* Yeni: Koyu Mavi */
            font-weight: 600;
            background-color: #ebf8ff; /* Yeni: Açık Mavi */
        }
        
        /* Sayfalama ellipsis (...) stili */
        .pagination-ellipsis {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            color: #718096; /* Yeni: Gri */
            font-weight: 500;
        }
        
        /* Mobil menü geçişi */
        #mobile-nav {
            transition: transform 0.3s ease-in-out;
        }
        
        /* Kategori menüsünün ve küçük resim galerisinin scrollbar'ını gizle (Webkit) */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        
        /* Yeni Tasarım: Ürün Kartı Stilleri */
        .product-card {
            border: 1px solid #e2e8f0; /* Açık gri border */
            border-radius: 0.5rem; /* rounded-lg */
            background-color: #ffffff;
            transition: all 0.3s ease;
        }
        .product-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-xl */
            border-color: #cbd5e0; /* Hover'da border rengi */
        }
        
        /* Yeni Tasarım: Header Stilleri */
        .header-icon-btn {
            color: #4a5568; /* Gri metin */
            padding: 0.5rem;
            border-radius: 0.375rem; /* rounded-md */
            transition: all 0.2s ease;
        }
        .header-icon-btn:hover {
            color: #1a202c; /* Koyu Gri */
            background-color: #f7fafc; /* Çok açık gri */
        }
        
        /* Yeni Tasarım: Sayfalama Butonları */
        .pagination-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500; /* medium */
            transition: all 0.15s ease;
            font-size: 0.875rem; /* text-sm */
            min-width: 40px;
            height: 40px;
            padding: 0 0.5rem;
        }
        .pagination-btn-nav {
             padding: 0 1rem;
        }
        .pagination-btn-disabled {
            background-color: #edf2f7; /* bg-gray-200 */
            color: #a0aec0; /* text-gray-400 */
            cursor: not-allowed;
        }
        .pagination-btn-active {
            background-color: #2c5282; /* Koyu Mavi */
            color: #ffffff;
            cursor: default;
        }
        .pagination-btn-default {
            background-color: #ffffff;
            color: #4a5568; /* text-gray-700 */
            border: 1px solid #e2e8f0; /* border-gray-300 */
        }
        .pagination-btn-default:hover {
             background-color: #f7fafc; /* bg-gray-100 */
        }
        
        /* Yeni Tasarım: Detay Sayfası Galeri */
        .thumbnail-btn.active {
            border-color: #2c5282; /* Koyu Mavi */
            box-shadow: 0 0 0 2px rgba(44, 82, 130, 0.3);
        }
        
    </style>
</head>
<body class="bg-gray-50"> <!-- Yeni Arka Plan Rengi -->

    <!-- MOBİL MENÜ (Kayar Panel) -->
    <div id="mobile-nav" class="fixed inset-0 bg-black bg-opacity-50 z-[60] transform -translate-x-full lg:hidden">
        <!-- Menü İçeriği -->
        <div id="mobile-menu-panel" class="relative w-4/5 max-w-sm h-full bg-white shadow-xl flex flex-col">
            <!-- Menü Başlığı -->
            <div class="flex justify-between items-center p-4 border-b border-gray-200">
                <!-- Yeni Logo Stili -->
                <a href="#/" class="text-2xl font-black text-gray-800 tracking-tight">Yc<span class="font-light">Store</span></a>
                <button id="mobile-nav-close" class="text-gray-500 hover:text-gray-800">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-7 h-7">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            
            <!-- Mobil Sepet Linki -->
            <a href="#cart" id="mobile-cart-link" class="relative flex items-center justify-between p-4 text-gray-700 hover:bg-gray-100 border-b border-gray-200">
                <span class="font-medium">Sepetim</span>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c.121 0 .239.04.335.117l2.828 2.09a.75.75 0 0 1-.028 1.258H7.5M7.5 14.25N6.623 10.5h11.25L16.5 14.25M7.5 14.25" />
                </svg>
            </a>

            <!-- Mobil Kategori Listesi -->
            <div class="p-4 overflow-y-auto no-scrollbar">
                <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3">Kategoriler</h3>
                <ul id="mobile-category-list" class="flex flex-col space-y-1">
                    <!-- Kategoriler JS ile buraya eklenecek -->
                </ul>
            </div>
        </div>
        <!-- Kapatmak için dışarı tıkla alanı (JS ile yönetiliyor) -->
    </div>

    <!-- HEADER -->
    <header class="bg-white shadow-sm sticky top-0 z-50 border-b border-gray-200">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            
            <!-- Mobil Menü Butonu (Sol) -->
            <button id="mobile-menu-btn" class="header-icon-btn lg:hidden">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-7 h-7">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                </svg>
            </button>
            
            <!-- Logo (Yeni Stil) -->
            <a href="#/" class="text-2xl md:text-3xl font-black text-gray-800 tracking-tight lg:mx-0">Yc<span class="font-light">Store</span></a>
            
            <!-- Masaüstü Arama Çubuğu (Yeni Stil) -->
            <div class="flex-1 max-w-2xl mx-8 hidden lg:block">
                <div class="relative">
                    <input type="text" id="search-input" placeholder="Ürün, marka veya model ara..." class="w-full px-5 py-3 rounded-lg border border-gray-300 focus:border-blue-700 focus:ring-1 focus:ring-blue-700 outline-none transition-colors bg-gray-50">
                    <div class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                        </svg>
                    </div>
                </div>
            </div>
            
            <!-- Sepet (Yeni Stil) -->
            <a href="#cart" id="cart-icon-link" class="relative flex-shrink-0 flex items-center header-icon-btn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-7 h-7">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c.121 0 .239.04.335.117l2.828 2.09a.75.75 0 0 1-.028 1.258H7.5M7.5 14.25N6.623 10.5h11.25L16.5 14.25M7.5 14.25" />
                </svg>
                <span class="ml-2 font-medium hidden lg:block">Sepetim</span>
                <span id="cart-badge" class="cart-badge" style="display: none;">0</span>
            </a>
        </div>
        
    </header>

    <!-- ANA İÇERİK ALANI -->
    <main id="app-container" class="container mx-auto p-4 my-8">

        <!-- YÜKLENİYOR... GÖSTERGESİ (Yeni Stil) -->
        <div id="loading-indicator" class="page active text-center py-20">
            <svg class="animate-spin h-12 w-12 text-blue-700 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <p class="mt-4 text-lg font-medium text-gray-700">Ürünler yükleniyor...</p>
        </div>

        <!-- ANA SAYFA / ÜRÜN LİSTESİ -->
        <div id="home-page" class="page">
            
            <!-- Mobil Arama Çubuğu (Yeni Stil) -->
            <div class="relative mb-6 lg:hidden">
                <input type="text" id="mobile-search-input" placeholder="Ürün, marka veya model ara..." class="w-full px-5 py-3 rounded-lg border border-gray-300 focus:border-blue-700 focus:ring-1 focus:ring-blue-700 outline-none transition-colors bg-white">
                <div class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                    </svg>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                
                <!-- Kategori Sidebar (Masaüstü - Yeni Stil) -->
                <aside class="hidden lg:block lg:col-span-3">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 sticky top-28">
                        <h3 class="text-lg font-bold text-gray-800 mb-4 border-b border-gray-200 pb-3">Kategoriler</h3>
                        <ul id="sidebar-category-list" class="flex flex-col space-y-1">
                            <!-- Kategoriler JS ile buraya eklenecek -->
                        </ul>
                    </div>
                </aside>

                <!-- Ana İçerik Alanı (Yeni Stil) -->
                <div class="lg:col-span-9 space-y-12">
                
                    <!-- 1. Hero Banner (Yeni Bölüm) -->
                    <div class="bg-gradient-to-r from-gray-800 to-gray-900 text-white p-8 md:p-12 rounded-lg shadow-lg flex items-center">
                        <div class="flex-1">
                            <h2 class="text-3xl md:text-4xl font-bold mb-3">Maksimum Performans</h2>
                            <p class="text-lg text-gray-300 mb-6">En yeni nesil bileşenlerle gücünüzü keşfedin.</p>
                            <a href="#category/Ekran%20Kartı" class="bg-white text-gray-900 font-bold py-3 px-6 rounded-lg hover:bg-gray-200 transition-colors">
                                Ekran Kartları
                            </a>
                        </div>
                        <div class="hidden md:block w-1/3">
                            <!-- Placeholder - Gerçek bir resim URL'si ile değiştirilebilir -->
                            <img src="https://placehold.co/300x200/374151/e5e7eb?text=PC+Bileşenleri" alt="PC Bileşenleri" class="rounded-lg object-cover">
                        </div>
                    </div>

                    <!-- 2. Küçük Tanıtım Kutuları (Yeni Bölüm) -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <a href="#category/İşlemci" class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow flex items-center space-x-3">
                            <img src="https://placehold.co/48x48/e0f2fe/0c4a6e?text=CPU" class="w-12 h-12 rounded-md" alt="İşlemci İkonu">
                            <div>
                                <h4 class="font-semibold text-gray-800">İşlemciler</h4>
                                <p class="text-sm text-gray-500">En hızlı CPU'lar</p>
                            </div>
                        </a>
                        <a href="#category/Monitör" class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow flex items-center space-x-3">
                             <img src="https://placehold.co/48x48/e0f2fe/0c4a6e?text=Ekran" class="w-12 h-12 rounded-md" alt="Monitör İkonu">
                            <div>
                                <h4 class="font-semibold text-gray-800">Monitörler</h4>
                                <p class="text-sm text-gray-500">Canlı Renkler</p>
                            </div>
                        </a>
                        <a href="#category/RAM" class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow flex items-center space-x-3">
                             <img src="https://placehold.co/48x48/e0f2fe/0c4a6e?text=RAM" class="w-12 h-12 rounded-md" alt="RAM İkonu">
                            <div>
                                <h4 class="font-semibold text-gray-800">Bellekler</h4>
                                <p class="text-sm text-gray-500">Yüksek Hız</p>
                            </div>
                        </a>
                         <a href="#category/Kasa" class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow flex items-center space-x-3">
                             <img src="https://placehold.co/48x48/e0f2fe/0c4a6e?text=Kasa" class="w-12 h-12 rounded-md" alt="Kasa İkonu">
                            <div>
                                <h4 class="font-semibold text-gray-800">Kasalar</h4>
                                <p class="text-sm text-gray-500">Şık Tasarımlar</p>
                            </div>
                        </a>
                    </div>
                    
                    <!-- 3. Öne Çıkan Kategori (Yeni Bölüm) -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Büyük Banner -->
                        <div class="lg:col-span-1 bg-gradient-to-b from-blue-800 to-blue-900 text-white p-6 rounded-lg flex flex-col justify-center items-start">
                            <h3 class="text-2xl font-bold mb-2">Yeni Nesil</h3>
                            <p class="text-4xl font-light mb-4">Ekran Kartları</p>
                            <p class="text-blue-200 mb-6">Oyunun kurallarını yeniden yazın.</p>
                            <a href="#category/Ekran%20Kartı" class="bg-white text-blue-900 font-bold py-2 px-5 rounded-lg hover:bg-blue-100 transition-colors text-sm">
                                Tümünü Gör
                            </a>
                        </div>
                        <!-- Ürün Grid'i -->
                        <div id="featured-gpu-grid" class="lg:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <!-- Öne çıkan ürün kartları buraya JS ile eklenecek -->
                        </div>
                    </div>

                    <!-- 4. Ana Ürün Alanı (Mevcut Bölüm) -->
                    <div>
                        <h2 id="page-title" class="text-2xl font-bold text-gray-800 mb-6">Tüm Ürünler</h2>
                        <div id="product-grid" class="grid grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 sm:gap-6">
                            <!-- Ürün kartları buraya JS ile eklenecek -->
                        </div>
                        
                        <!-- Sayfalama (Yeni Stil) -->
                        <div id="pagination-controls" class="flex flex-wrap justify-center items-center space-x-1 sm:space-x-2 mt-12">
                            <!-- Sayfa numaraları buraya JS ile eklenecek -->
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>

        <!-- ÜRÜN DETAY SAYFASI (Yeni Tasarım) -->
        <div id="detail-page" class="page">
            <div class="mb-6">
                <a href="#/" class="inline-flex items-center text-blue-700 hover:text-blue-900 font-medium hover:underline">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5 mr-1">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5" />
                    </svg>
                    Alışverişe Geri Dön
                </a>
            </div>
            <div id="product-detail-content" class="bg-white p-6 md:p-8 rounded-xl shadow-lg border border-gray-200">
                <!-- Detay içeriği buraya JS ile eklenecek -->
            </div>
        </div>

        <!-- SEPET SAYFASI (Yeni Tasarım) -->
        <div id="cart-page" class="page">
            <h2 class="text-3xl font-bold text-gray-800 mb-8">Sepetim</h2>
            <div id="cart-content" class="flex flex-col lg:grid lg:grid-cols-3 gap-8">
                <!-- Sepet içeriği buraya JS ile eklenecek -->
            </div>
        </div>

    </main>

    <!-- FOOTER (Yeni Tasarım) -->
    <footer class="bg-gray-800 text-gray-400 mt-16 border-t-4 border-blue-800">
        <div class="container mx-auto px-4 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 text-center md:text-left">
                <!-- Logo ve Sosyal Medya -->
                <div>
                     <!-- Yeni Logo Stili -->
                    <h3 class="text-3xl font-black text-white mb-4">Yc<span class="font-light">Store</span></h3>
                    <p class="text-gray-400 mb-4">En iyi PC donanımları için tek adresiniz.</p>
                </div>
                
                <!-- Hızlı Linkler -->
                <div>
                    <h4 class="text-lg font-semibold text-white mb-4">Hızlı Linkler</h4>
                    <ul class="space-y-2">
                        <li><a href="#/" class="hover:text-white hover:underline">Ana Sayfa</a></li>
                        <li><a href="#cart" class="hover:text-white hover:underline">Sepetim</a></li>
                        <li><a href="#" class="hover:text-white hover:underline">Hesabım</a></li>
                    </ul>
                </div>

                <!-- Kategoriler -->
                <div>
                    <h4 class="text-lg font-semibold text-white mb-4">Kategoriler</h4>
                    <ul id="footer-category-list" class="space-y-2">
                        <!-- Kategori linkleri JS ile eklenecek -->
                    </ul>
                </div>

                <!-- İletişim -->
                <div>
                    <h4 class="text-lg font-semibold text-white mb-4">İletişim</h4>
                    <ul class="space-y-2 text-gray-400">
                        <li>Email: yusufciran16@gmail.com</li>
                        <li>Telefon: +90 551 671 56 25</li>
                        <li>Adres: Osmangazi, Bursa</li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 text-center text-gray-500">
                <p>&copy; 2025 Tüm Hakları Saklıdır. Yc Store.</p>
            </div>
        </div>
    </footer>
    
    <!-- Bildirim (Toast) Mesajı (Yeni Stil) -->
    <div id="toast-notification" class="fixed bottom-10 right-10 z-[70] bg-gray-900 text-white px-6 py-3 rounded-lg shadow-xl translate-x-full opacity-0 transition-all duration-300 ease-out flex items-center space-x-3">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-green-400">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
        </svg>
        <span id="toast-message"></span>
    </div>

    <!-- JAVASCRIPT KODLARI -->
    <script type="module">
        // --- UYGULAMA DEĞİŞKENLERİ ---
        
        /** @type {Array<Object>} */
        let allProducts = []; // Sunucudan gelen tüm ürünler
        
        /** @type {Array<Object>} */
        let filteredProducts = []; // Arama ve kategori filtresi sonrası ürünler
        
        /** @type {Array<Object>} */
        let cart = []; // Sepetteki ürünler (quantity alanı eklenmiş)
        
        let currentPage = 1;
        const productsPerPage = 12; // Her sayfada 12 ürün göster
        
        let currentCategory = 'Tümü'; // Aktif kategoriyi takip et
        
        const categories = [
            "Tümü", "Ekran Kartı", "İşlemci", "Anakart", "RAM", "SSD", "Güç Kaynağı", "Kasa", "Soğutma", "Monitör", "Klavye", "Mouse", "Kulaklık", "Hoparlör", "Diğer"
        ];

        // --- DOM ELEMENTLERİ ---
        const appContainer = document.getElementById('app-container');
        const loadingIndicator = document.getElementById('loading-indicator');
        
        // Sayfalar
        const pages = {
            home: document.getElementById('home-page'),
            detail: document.getElementById('detail-page'),
            cart: document.getElementById('cart-page'),
        };
        
        // Ana Sayfa Elementleri
        const productGrid = document.getElementById('product-grid');
        const featuredGpuGrid = document.getElementById('featured-gpu-grid'); // YENİ
        const paginationControls = document.getElementById('pagination-controls');
        const pageTitle = document.getElementById('page-title');
        
        // Detay Sayfası Elementleri
        const productDetailContent = document.getElementById('product-detail-content');
        
        // Sepet Sayfası Elementleri
        const cartContent = document.getElementById('cart-content');
        
        // Header Elementleri
        const searchInput = document.getElementById('search-input');
        const mobileSearchInput = document.getElementById('mobile-search-input');
        const cartBadge = document.getElementById('cart-badge');
        
        // Mobil Navigasyon Elementleri
        const mobileNav = document.getElementById('mobile-nav');
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileNavClose = document.getElementById('mobile-nav-close');
        const mobileMenuPanel = document.getElementById('mobile-menu-panel');
        const mobileCartLink = document.getElementById('mobile-cart-link');

        // Kategori Listeleri
        const sidebarCategoryList = document.getElementById('sidebar-category-list');
        const mobileCategoryList = document.getElementById('mobile-category-list');
        const footerCategoryList = document.getElementById('footer-category-list');
        
        // Bildirim Elementi
        const toast = document.getElementById('toast-notification');
        const toastMessage = document.getElementById('toast-message');

        // --- UYGULAMA BAŞLANGICI ---

        document.addEventListener('DOMContentLoaded', initializeApp);

        /**
         * Uygulamayı başlatan ana fonksiyon
         */
        async function initializeApp() {
            populateCategoryLists();
            loadCartFromStorage();
            addEventListeners();
            
            try {
                const response = await fetch('fiyatlar.json'); 
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                allProducts = await response.json();
                
                allProducts = allProducts.map(p => {
                    let uniqueId = '';
                    if (p.urun_linki.includes('urun-')) {
                        const parts = p.urun_linki.split('urun-');
                        uniqueId = parts[parts.length - 1];
                    } else {
                        const parts = p.urun_linki.split('/');
                        uniqueId = parts[parts.length - 1];
                    }
                    
                    return { 
                        ...p, 
                        id: uniqueId,
                        categoryKeyword: detectCategory(p.aciklama) 
                    };
                });
                
                filteredProducts = [...allProducts];
                
                handleRouting();
                updateActiveCategoryStyles();
                
            } catch (error) {
                console.error("Ürünler yüklenirken hata oluştu:", error);
                appContainer.innerHTML = `<p class="col-span-full text-center text-red-500 text-lg">Ürünler yüklenemedi. Lütfen 'fiyatlar.json' dosyasının doğru yerde olduğundan emin olun. Hata: ${error.message}</p>`;
            } finally {
                loadingIndicator.classList.remove('active');
            }
        }

        /**
         * Gerekli tüm olay dinleyicilerini ekler
         */
        function addEventListeners() {
            window.addEventListener('hashchange', handleRouting);
            
            searchInput.addEventListener('input', (e) => handleSearch(e.target.value));
            mobileSearchInput.addEventListener('input', (e) => handleSearch(e.target.value));
            
            mobileMenuBtn.addEventListener('click', () => toggleMobileNav(true));
            mobileNavClose.addEventListener('click', () => toggleMobileNav(false));
            
            mobileNav.addEventListener('click', () => toggleMobileNav(false));
            mobileMenuPanel.addEventListener('click', (e) => e.stopPropagation());
            mobileCartLink.addEventListener('click', () => toggleMobileNav(false));
            
            sidebarCategoryList.addEventListener('click', (e) => {
                const link = e.target.closest('.category-link');
                if (link) {
                    e.preventDefault();
                    const category = link.dataset.category;
                    window.location.hash = category === 'Tümü' ? '/' : `#category/${encodeURIComponent(category)}`;
                }
            });
            
            mobileCategoryList.addEventListener('click', (e) => {
                const link = e.target.closest('.category-link');
                if (link) {
                    e.preventDefault(); 
                    const category = link.dataset.category;
                    window.location.hash = category === 'Tümü' ? '/' : `#category/${encodeURIComponent(category)}`;
                    toggleMobileNav(false); 
                }
            });
            
            footerCategoryList.addEventListener('click', (e) => {
                const link = e.target.closest('.category-link');
                if (link) {
                    window.scrollTo(0, 0);
                }
            });
        }
        
        /**
         * Mobil menüyü açar veya kapatır
         * @param {boolean} show Gösterilsin mi?
         */
        function toggleMobileNav(show) {
            if (show) {
                mobileNav.classList.remove('-translate-x-full');
            } else {
                mobileNav.classList.add('-translate-x-full');
            }
        }
        
        /**
         * Sidebar, mobil menü ve footer'daki kategori listelerini doldurur
         */
        function populateCategoryLists() {
            sidebarCategoryList.innerHTML = '';
            mobileCategoryList.innerHTML = '';
            footerCategoryList.innerHTML = '';
            
            categories.forEach(category => {
                const categoryHash = encodeURIComponent(category);
                const href = category === 'Tümü' ? '#/' : `#category/${categoryHash}`;
                
                // Sidebar ve Mobil Linkleri (Yeni Stil)
                const mainLi = document.createElement('li');
                mainLi.innerHTML = `<a href="${href}" class="category-link block px-3 py-2 rounded-md transition-colors duration-150 hover:bg-blue-50 text-gray-700" data-category="${category}">${category}</a>`;
                
                // Footer Linkleri (Yeni Stil)
                const footerLi = document.createElement('li');
                footerLi.innerHTML = `<a href="${href}" class="category-link hover:text-white hover:underline text-gray-400" data-category="${category}">${category}</a>`;

                sidebarCategoryList.appendChild(mainLi.cloneNode(true));
                mobileCategoryList.appendChild(mainLi);
                footerCategoryList.appendChild(footerLi);
            });
        }
        
        /**
         * Tüm kategori linklerindeki aktif stilini günceller
         */
        function updateActiveCategoryStyles() {
            document.querySelectorAll('.category-link').forEach(link => {
                if (link.dataset.category === currentCategory) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });
        }
        
        // --- YÖNLENDİRME (ROUTING) ---

        /**
         * URL hash'ine göre ilgili sayfayı render eder
         */
        function handleRouting() {
            const hash = window.location.hash;
            
            if (hash.startsWith('#product/')) {
                const productId = decodeURIComponent(hash.substring(9)); 
                renderDetailPage(productId);
            } else if (hash === '#cart') {
                renderCartPage();
            } else if (hash.startsWith('#category/')) {
                const category = decodeURIComponent(hash.substring(10));
                handleCategoryFilter(category);
                renderHomePage();
            } else {
                handleCategoryFilter('Tümü');
                renderHomePage();
                if (hash !== '#/') {
                    if(hash.length > 1) {
                        history.pushState("", document.title, window.location.pathname + window.location.search);
                    }
                }
            }
        }
        
        /**
         * Sayfalar arasında geçişi yönetir
         * @param {string} activePageId Gösterilecek sayfanın ID'si ('home', 'detail', 'cart')
         */
        function showPage(activePageId) {
            Object.values(pages).forEach(page => page.classList.remove('active'));
            if (pages[activePageId]) {
                pages[activePageId].classList.add('active');
            }
            window.scrollTo(0, 0);
        }

        // --- SAYFA RENDER FONKSİYONLARI ---

        /**
         * Ana sayfayı ve ürünleri render eder
         */
        function renderHomePage() {
            productGrid.innerHTML = ''; // Ana grid'i temizle
            
            // YENİ: Öne çıkan ürünleri render et
            renderFeaturedProducts('Ekran Kartı', featuredGpuGrid, 4);
            
            pageTitle.innerText = currentCategory === 'Tümü' ? 'Tüm Ürünler' : currentCategory;
            
            const startIndex = (currentPage - 1) * productsPerPage;
            const endIndex = startIndex + productsPerPage;
            const productsToShow = filteredProducts.slice(startIndex, endIndex);

            if (productsToShow.length === 0) {
                productGrid.innerHTML = `<p class="col-span-full text-center text-gray-500 text-lg">Seçilen kategori veya aramanızla eşleşen ürün bulunamadı.</p>`;
            } else {
                productsToShow.forEach(product => {
                    const productCard = createProductCard(product); // Normal kart
                    productGrid.appendChild(productCard);
                });
            }
            
            renderPagination();
            showPage('home');
        }
        
        /**
         * YENİ: Öne çıkan ürünler bölümünü render eder
         * @param {string} categoryName Gösterilecek kategori
         * @param {HTMLElement} containerElement Kartların ekleneceği element
         * @param {number} count Gösterilecek ürün sayısı
         */
        function renderFeaturedProducts(categoryName, containerElement, count) {
            if (!containerElement) return;
            
            containerElement.innerHTML = ''; // Konteyneri temizle
            
            const categoryTerm = categoryName.toLowerCase();
            const featured = allProducts
                .filter(p => p.categoryKeyword && p.categoryKeyword.toLowerCase() === categoryTerm)
                .slice(0, count); // İlk 'count' ürünü al
                
            if (featured.length === 0) {
                containerElement.innerHTML = `<p class="col-span-full text-center text-gray-500">Öne çıkan ürün bulunamadı.</p>`;
            } else {
                featured.forEach(product => {
                    // Öne çıkanlar için küçük kartlar (yeni fonksiyon)
                    const featuredCard = createFeaturedProductCard(product); 
                    containerElement.appendChild(featuredCard);
                });
            }
        }
        
        /**
         * Ürün detay sayfasını render eder (Yeni Tasarım)
         * @param {string} productId Gösterilecek ürünün ID'si
         */
        function renderDetailPage(productId) {
            const product = allProducts.find(p => p.id === productId); 
            
            if (!product) {
                productDetailContent.innerHTML = `<p class="text-red-500">Ürün bulunamadı.</p>`;
                showPage('detail');
                return;
            }
            
            const anaGorsel = (product.detay_gorseller && product.detay_gorseller.length > 0) 
                                ? product.detay_gorseller[0] 
                                : product.resim_linki;

            productDetailContent.innerHTML = `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 items-start">
                    
                    <!-- Ürün Galerisi (Yeni Stil) -->
                    <div class="lg:sticky lg:top-28">
                        <!-- Ana Resim -->
                        <div class="bg-white rounded-lg p-4 border border-gray-200 mb-4">
                            <img id="main-product-image" src="${anaGorsel}" 
                                 alt="${product.aciklama}" class="w-full h-auto max-h-[450px] object-contain rounded-md transition-all duration-300" 
                                 onerror="this.onerror=null; this.src='https://placehold.co/600x600/f1f5f9/94a3b8?text=Resim+Yok';">
                        </div>
                        <!-- Küçük Resimler Galerisi -->
                        <div id="thumbnail-gallery" class="flex space-x-2 overflow-x-auto p-1 no-scrollbar">
                            <!-- Küçük resimler buraya JS ile eklenecek -->
                        </div>
                    </div>
                    
                    <!-- Ürün Bilgileri (Yeni Stil) -->
                    <div class="flex flex-col">
                        <h1 class="text-2xl md:text-3xl font-bold text-gray-900 mb-3">${product.aciklama}</h1>
                        
                        <div class="mb-5">
                            ${product.kargo ? 
                                `<span class="text-sm font-medium text-green-700 bg-green-100 px-3 py-1 rounded-full">${product.kargo}</span>` : 
                                '<span class="text-sm font-medium text-blue-700 bg-blue-100 px-3 py-1 rounded-full">Standart Kargo</span>'
                            }
                        </div>
                        
                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6">
                            <span class="text-sm text-gray-600">Fiyat</span>
                            <p class="text-3xl md:text-4xl font-extrabold text-blue-700">${formatPrice(product.fiyat)} TL</p>
                        </div>
                        
                        <button class="add-to-cart-btn w-full bg-blue-700 hover:bg-blue-800 text-white font-bold py-4 px-6 rounded-lg text-lg transition-colors duration-200 flex items-center justify-center space-x-3" data-id="${product.id}">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                            </svg>
                            <span>Sepete Ekle</span>
                        </button>
                        
                        <div class="mt-8 border-t border-gray-200 pt-6">
                            <h4 class="text-lg font-semibold text-gray-800 mb-3">Açıklama</h4>
                            <p class="text-gray-600 leading-relaxed">${product.aciklama}</p>
                        </div>
                    </div>
                </div>
            `;
            
            // --- GALERİ YÖNETİMİ ---
            const mainImage = productDetailContent.querySelector('#main-product-image');
            const thumbnailGallery = productDetailContent.querySelector('#thumbnail-gallery');
            
            const gorseller = (product.detay_gorseller && product.detay_gorseller.length > 0) 
                                ? product.detay_gorseller 
                                : [product.resim_linki];
            
            if (gorseller.length > 1) {
                thumbnailGallery.innerHTML = gorseller.map((gorsel, index) => `
                    <button class="thumbnail-btn flex-shrink-0 w-20 h-20 rounded-md border-2 p-1 transition-all ${index === 0 ? 'active border-blue-700' : 'border-gray-200 hover:border-gray-400'}" data-src="${gorsel}">
                        <img src="${gorsel}" alt="Küçük resim ${index + 1}" class="w-full h-full object-contain rounded-sm" 
                             onerror="this.onerror=null; this.src='https://placehold.co/80x80/f1f5f9/94a3b8?text=...';">
                    </button>
                `).join('');
    
                thumbnailGallery.addEventListener('click', (e) => {
                    const btn = e.target.closest('.thumbnail-btn');
                    if (!btn) return;
                    
                    const newSrc = btn.dataset.src;
                    mainImage.src = newSrc;
                    
                    thumbnailGallery.querySelectorAll('.thumbnail-btn').forEach(b => b.classList.remove('active', 'border-blue-700'));
                    btn.classList.add('active', 'border-blue-700');
                });
            } else {
                 thumbnailGallery.style.display = 'none';
            }
            // --- GALERİ YÖNETİMİ BİTİŞİ ---

            productDetailContent.querySelector('.add-to-cart-btn').addEventListener('click', (e) => {
                addToCart(e.currentTarget.dataset.id);
            });
            
            showPage('detail');
        }
        
        /**
         * Sepet sayfasını render eder (Yeni Stil)
         */
        function renderCartPage() {
            if (cart.length === 0) {
                cartContent.innerHTML = `
                    <div class="lg:col-span-3 text-center bg-white p-12 rounded-lg shadow-sm border border-gray-200">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-24 h-24 text-gray-300 mx-auto mb-4">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c.121 0 .239.04.335.117l2.828 2.09a.75.75 0 0 1-.028 1.258H7.5M7.5 14.25N6.623 10.5h11.25L16.5 14.25M7.5 14.25" />
                        </svg>
                        <h3 class="text-2xl font-semibold text-gray-800 mb-2">Sepetiniz şu anda boş</h3>
                        <p class="text-gray-500 mb-6">Hemen alışverişe başlayın ve harika ürünleri keşfedin.</p>
                        <a href="#/" class="bg-blue-700 hover:bg-blue-800 text-white font-bold py-3 px-8 rounded-lg transition-colors">Alışverişe Başla</a>
                    </div>
                `;
            } else {
                const itemsHtml = cart.map(item => `
                    <div class="flex items-start space-x-4 bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                        <img src="${item.kucuk_resim_linki}" alt="${item.aciklama}" class="w-24 h-24 object-contain rounded-md border border-gray-200" 
                             onerror="this.onerror=null; this.src='https://placehold.co/100x100/f1f5f9/94a3b8?text=Resim';">
                        <div class="flex-1 min-w-0">
                            <p class="font-medium text-gray-800 truncate" title="${item.aciklama}">${item.aciklama}</p>
                            <p class="text-lg font-bold text-blue-700 my-2">${formatPrice(item.fiyat)} TL</p>
                            <!-- Adet Güncelleme (Yeni Stil) -->
                            <div class="flex items-center space-x-2">
                                <button class="quantity-btn p-1 rounded-full bg-gray-200 hover:bg-gray-300 transition-colors text-gray-700" data-id="${item.id}" data-change="-1">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14" /></svg>
                                </button>
                                <span class="font-bold w-8 text-center text-gray-800">${item.quantity}</span>
                                <button class="quantity-btn p-1 rounded-full bg-gray-200 hover:bg-gray-300 transition-colors text-gray-700" data-id="${item.id}" data-change="1">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" /></svg>
                                </button>
                            </div>
                        </div>
                        <button class="remove-from-cart-btn text-gray-400 hover:text-red-500 transition-colors" data-id="${item.id}" title="Sepetten Çıkar">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                `).join('');

                const subtotal = cart.reduce((acc, item) => acc + (item.fiyat * item.quantity), 0);
                const shipping = subtotal > 500 ? 0 : 49.90;
                const total = subtotal + shipping;
                
                const summaryHtml = `
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 lg:sticky lg:top-28">
                        <h3 class="text-xl font-bold border-b border-gray-200 pb-3 mb-4 text-gray-800">Sipariş Özeti</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Ara Toplam</span>
                                <span class="font-medium text-gray-800">${formatPrice(subtotal)} TL</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Kargo</span>
                                ${shipping === 0 ? 
                                    `<span class="font-medium text-green-600">Bedava</span>` : 
                                    `<span class="font-medium text-gray-800">${formatPrice(shipping)} TL</span>`
                                }
                            </div>
                            ${subtotal < 500 ? 
                                `<p class="text-xs text-center text-green-700 bg-green-50 p-2 rounded-md"><b>${formatPrice(500 - subtotal)} TL</b> daha ekleyin, kargo bedava!</p>` : ''
                            }
                            <div class="flex justify-between text-lg font-bold pt-3 border-t border-gray-200">
                                <span class="text-gray-800">Toplam</span>
                                <span class="text-blue-700">${formatPrice(total)} TL</span>
                            </div>
                        </div>
                        <button class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg text-lg transition-colors duration-200 mt-6 flex items-center justify-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z" /></svg>
                            <span>Güvenli Ödemeye Geç</span>
                        </button>
                    </div>
                `;

                cartContent.innerHTML = `
                    <div class="lg:col-span-2 space-y-4 w-full order-1">
                        ${itemsHtml}
                    </div>
                    <div class="lg:col-span-1 w-full order-2">
                        ${summaryHtml}
                    </div>
                `;
                
                cartContent.querySelectorAll('.quantity-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const id = e.currentTarget.dataset.id;
                        const change = parseInt(e.currentTarget.dataset.change);
                        updateCartQuantity(id, change);
                    });
                });
                
                cartContent.querySelectorAll('.remove-from-cart-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        removeFromCart(e.currentTarget.dataset.id);
                    });
                });
            }
            
            showPage('cart');
        }

        // --- YARDIMCI RENDER FONKSİYONLARI ---

        /**
         * Tek bir ana ürün kartı HTML'i oluşturur (Yeni Stil)
         * @param {Object} product Ürün objesi
         * @returns {HTMLElement} Oluşturulan div elementi
         */
        function createProductCard(product) {
            const card = document.createElement('div');
            card.className = 'product-card overflow-hidden flex flex-col';
            
            card.innerHTML = `
                <a href="#product/${encodeURIComponent(product.id)}" class="block group">
                    <div class="overflow-hidden bg-white p-4">
                        <img src="${product.kucuk_resim_linki}" alt="${product.aciklama}" 
                             class="w-full h-48 object-contain transition-transform duration-300 group-hover:scale-105" 
                             onerror="this.onerror=null; this.src='https://placehold.co/320x320/f1f5f9/94a3b8?text=Resim+Yok';">
                    </div>
                </a>
                <div class="p-4 flex flex-col flex-1 border-t border-gray-200">
                    <a href="#product/${encodeURIComponent(product.id)}" class="flex-1">
                        <h3 class="text-sm font-medium text-gray-800 h-10 line-clamp-2 hover:text-blue-700">${product.aciklama}</h3>
                    </a>
                    <div class="mt-4">
                        <span class="text-xl font-bold text-gray-900">${formatPrice(product.fiyat)} TL</span>
                        ${product.kargo ? `<p class="text-xs text-green-600 font-medium mt-1">${product.kargo}</p>` : ''}
                    </div>
                    <button class="add-to-cart-btn w-full mt-4 bg-blue-600 text-white hover:bg-blue-700 font-semibold py-2 px-4 rounded-lg transition-colors text-sm flex items-center justify-center space-x-2" data-id="${product.id}">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" /></svg>
                        <span>Sepete Ekle</span>
                    </button>
                </div>
            `;
            
            card.querySelector('.add-to-cart-btn').addEventListener('click', (e) => {
                addToCart(e.currentTarget.dataset.id);
            });
            
            return card;
        }
        
        /**
         * YENİ: Öne çıkanlar için küçük ürün kartı HTML'i oluşturur
         * @param {Object} product Ürün objesi
         * @returns {HTMLElement} Oluşturulan div elementi
         */
        function createFeaturedProductCard(product) {
            const card = document.createElement('a');
            card.href = `#product/${encodeURIComponent(product.id)}`;
            card.className = 'product-card p-3 flex items-center space-x-3'; // product-card'ın hover efektini alır

            card.innerHTML = `
                <div class="flex-shrink-0 bg-white p-1 rounded-md w-20 h-20 flex items-center justify-center">
                    <img src="${product.kucuk_resim_linki}" alt="${product.aciklama}" 
                         class="w-full h-full object-contain" 
                         onerror="this.onerror=null; this.src='https://placehold.co/80x80/f1f5f9/94a3b8?text=...';">
                </div>
                <div class="flex-1 min-w-0">
                    <h4 class="text-sm font-medium text-gray-800 line-clamp-2 hover:text-blue-700">${product.aciklama}</h4>
                    <p class="text-lg font-bold text-gray-900 mt-1">${formatPrice(product.fiyat)} TL</p>
                </div>
            `;
            
            // Not: Bu kartın kendisine tıklandığında detay sayfasına gider,
            // ayrı bir 'sepete ekle' butonu yoktur.
            
            return card;
        }
        
        /**
         * Gelişmiş sayfalama kontrollerini oluşturur (Yeni Stil)
         */
        function renderPagination() {
            paginationControls.innerHTML = '';
            const totalPages = Math.ceil(filteredProducts.length / productsPerPage);
            
            if (totalPages <= 1) return;

            const maxButtons = 7;
            let pagesToShow = [];

            if (totalPages <= maxButtons) {
                for (let i = 1; i <= totalPages; i++) {
                    pagesToShow.push(i);
                }
            } else {
                let startPages = [1];
                let endPages = [totalPages];
                let middlePages = [];
                
                for (let i = Math.max(2, currentPage - 1); i <= Math.min(totalPages - 1, currentPage + 1); i++) {
                    middlePages.push(i);
                }

                let allPages = [...startPages, ...middlePages, ...endPages]
                    .filter((value, index, self) => self.indexOf(value) === index) 
                    .sort((a, b) => a - b); 

                let prevPage = 0;
                for (const page of allPages) {
                    if (prevPage + 1 < page) {
                        pagesToShow.push('...'); 
                    }
                    pagesToShow.push(page);
                    prevPage = page;
                }
            }

            // Önceki Butonu
            paginationControls.appendChild(
                createPaginationButton('Önceki', currentPage > 1 ? currentPage - 1 : null, false, true)
            );
            
            // Sayfa Numaraları ve Ellipsis
            pagesToShow.forEach(page => {
                if (page === '...') {
                    paginationControls.appendChild(createPaginationEllipsis());
                } else {
                    paginationControls.appendChild(
                        createPaginationButton(page.toString(), page, page === currentPage)
                    );
                }
            });
            
            // Sonraki Butonu
            paginationControls.appendChild(
                createPaginationButton('Sonraki', currentPage < totalPages ? currentPage + 1 : null, false, true)
            );
        }
        
        /**
         * Tek bir sayfalama butonu oluşturur (Yeni Stil)
         */
        function createPaginationButton(text, pageNumber, isActive = false, isNav = false) {
            const button = document.createElement('button');
            button.innerText = text;
            
            let baseClasses = 'pagination-btn';
            let navClasses = isNav ? 'pagination-btn-nav' : '';
            
            if (pageNumber === null) {
                button.className = `${baseClasses} ${navClasses} pagination-btn-disabled`;
                button.disabled = true;
            } else if (isActive) {
                button.className = `${baseClasses} ${navClasses} pagination-btn-active`;
            } else {
                button.className = `${baseClasses} ${navClasses} pagination-btn-default`;
                button.addEventListener('click', () => {
                    currentPage = pageNumber;
                    renderHomePage();
                });
            }
            return button;
        }

        /**
         * Sayfalama için '...' (ellipsis) elementi oluşturur
         */
        function createPaginationEllipsis() {
            const span = document.createElement('span');
            span.className = 'pagination-ellipsis text-sm';
            span.innerText = '...';
            return span;
        }

        // --- FİLTRELEME VE ARAMA ---

        /**
         * Arama çubuğuna yazılan metne göre ürünleri filtreler
         */
        function handleSearch(searchTerm) {
            const term = searchTerm.toLowerCase().trim();
            
            if (document.activeElement === searchInput) {
                mobileSearchInput.value = searchTerm;
            } else {
                searchInput.value = searchTerm;
            }
            
            filteredProducts = allProducts.filter(product => {
                const lowerAciklama = product.aciklama.toLowerCase();
                const lowerCategory = product.categoryKeyword.toLowerCase(); 
                return lowerAciklama.includes(term) || lowerCategory.includes(term);
            });
            currentPage = 1;
            
            // YENİ: Arama yapınca ana sayfadaki özel bölümleri gizle
            toggleFeaturedSections(!term);
            
            pageTitle.innerText = term ? `Arama Sonuçları: "${term}"` : 'Tüm Ürünler';
            currentCategory = 'Tümü';
            updateActiveCategoryStyles();
            
            if(window.location.hash) {
                 history.pushState("", document.title, window.location.pathname + window.location.search);
            }
            renderHomePage();
        }

        /**
         * Kategoriye göre ürünleri filtreler
         */
        function handleCategoryFilter(category) {
            currentCategory = category;
            
            // YENİ: Kategori seçilince ana sayfadaki özel bölümleri göster/gizle
            toggleFeaturedSections(category === 'Tümü');
            
            if (category === 'Tümü') {
                filteredProducts = [...allProducts].sort(() => 0.5 - Math.random());
            } else {
                const categoryTerm = category.toLowerCase();
                filteredProducts = allProducts.filter(product => {
                    return product.categoryKeyword && product.categoryKeyword.toLowerCase() === categoryTerm;
                });
            }
            
            currentPage = 1;
            updateActiveCategoryStyles();
            
            searchInput.value = '';
            mobileSearchInput.value = '';
            
            toggleMobileNav(false);
        }
        
        /**
         * YENİ: Ana sayfadaki özel banner/öne çıkanlar bölümlerini gösterir/gizler
         * @param {boolean} show Gösterilsin mi?
         */
        function toggleFeaturedSections(show) {
            const homePage = document.getElementById('home-page');
            const featuredSections = homePage.querySelectorAll('.lg\\:col-span-9 > div:not(:last-child)'); // Ana grid dışındaki her şey
            
            if (show) {
                featuredSections.forEach(section => section.style.display = 'grid'); // veya 'block', 'flex' vs.
                // Hero banner'ın display'ini düzelt
                const hero = homePage.querySelector('.lg\\:col-span-9 > div:first-child');
                if (hero) hero.style.display = 'flex';
                
            } else {
                featuredSections.forEach(section => section.style.display = 'none');
            }
        }
        
        /**
         * Ürün açıklamasına göre kategoriyi akıllıca tahmin eder
         */
        function detectCategory(aciklama) {
            const lowerAciklama = aciklama.toLowerCase();
            
            if (lowerAciklama.includes('mouse') || lowerAciklama.includes('fare')) return "Mouse";
            if (lowerAciklama.includes('klavye') || lowerAciklama.includes('keyboard')) return "Klavye";
            if (lowerAciklama.includes('kulaklık') || lowerAciklama.includes('headset')) return "Kulaklık";
            if (lowerAciklama.includes('hoparlör') || lowerAciklama.includes('speaker')) return "Hoparlör";
            if (lowerAciklama.includes('monitör') || lowerAciklama.includes('monitor') || /\d{2,}\s*inç|\d{2,}"/i.test(aciklama)) return "Monitör";
            if (/\b(rtx|gtx)\s*(\d{4}|\d{3}0)/i.test(lowerAciklama) || /\b(rx)\s*(\d{4}|\d{3}0)/i.test(lowerAciklama) || lowerAciklama.includes('arc a')) return "Ekran Kartı";
            if (/\b(b\d{3}m?|x\d{3}|z\d{3}|a\d{3})\b/i.test(lowerAciklama) && !lowerAciklama.includes('kasa')) return "Anakart";
            if (/\b(ryzen|core i)\s*(\d|x)\b/i.test(lowerAciklama) || lowerAciklama.includes('soket')) return "İşlemci";
            if (/\d+gb\s*ddr\d/i.test(lowerAciklama) || (lowerAciklama.includes('ram') && !lowerAciklama.includes('ekran kartı'))) return "RAM";
            if (lowerAciklama.includes('ssd') || lowerAciklama.includes('m.2') || lowerAciklama.includes('nvme')) return "SSD";
            if (lowerAciklama.includes('psu') || lowerAciklama.includes('güç kaynağı') || (/\d{3,}w/i.test(lowerAciklama) && (lowerAciklama.includes('80+') || lowerAciklama.includes('pfc')))) return "Güç Kaynağı";
            if ((lowerAciklama.includes('soğutucu') || lowerAciklama.includes('soğutma') || lowerAciklama.includes('cooler') || lowerAciklama.includes('fan'))
                && !lowerAciklama.includes('kasa') && !lowerAciklama.includes('güç kaynağı') && !lowerAciklama.includes('psu')
                && !/\b(rtx|gtx|rx)\b/i.test(lowerAciklama)) return "Soğutma";
            if (lowerAciklama.includes('kasa') || lowerAciklama.includes('case')) return "Kasa";
            if (lowerAciklama.includes('anakart') || lowerAciklama.includes('motherboard')) return "Anakart";
            if (lowerAciklama.includes('ekran kartı')) return "Ekran Kartı";
            if (lowerAciklama.includes('işlemci')) return "İşlemci";

            const match = aciklama.match(/\(([^)]+)\)$/);
            if (match) {
                const potentialCategory = match[1].trim();
                if (categories.slice(1).find(c => c.toLowerCase() === potentialCategory.toLowerCase())) {
                    return categories.find(c => c.toLowerCase() === potentialCategory.toLowerCase());
                }
            }
            return "Diğer";
        }

        // --- SEPET İŞLEVLERİ ---

        /**
         * Sepete ürün ekler
         */
        function addToCart(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) return;

            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            
            saveCartToStorage();
            updateCartBadge();
            showToast(`${product.aciklama.substring(0, 30)}... sepete eklendi!`);
        }
        
        /**
         * Sepetten ürün çıkarır
         */
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            saveCartToStorage();
            updateCartBadge();
            renderCartPage();
        }
        
        /**
         * Sepetteki ürünün miktarını günceller
         */
        function updateCartQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                } else {
                    saveCartToStorage();
                    updateCartBadge();
                    renderCartPage();
                }
            }
        }
        
        /**
         * Sepet ikonundaki sayacı günceller
         */
        function updateCartBadge() {
            const totalItems = cart.reduce((acc, item) => acc + item.quantity, 0);
            
            if (totalItems > 0) {
                cartBadge.innerText = totalItems;
                cartBadge.style.display = 'flex';
            } else {
                cartBadge.style.display = 'none';
            }
        }
        
        /**
         * Sepeti localStorage'a kaydeder
         */
        function saveCartToStorage() {
            localStorage.setItem('pcDunyasiCart', JSON.stringify(cart));
        }
        
        /**
         * Sepeti localStorage'dan yükler
         */
        function loadCartFromStorage() {
            const savedCart = localStorage.getItem('pcDunyasiCart');
            if (savedCart) {
                cart = JSON.parse(savedCart);
            }
            updateCartBadge();
        }

        // --- DİĞER YARDIMCI FONKSİYONLAR ---
        
        /**
         * Fiyatı formatlar (örn: 1500.90 -> 1.500,90)
         */
        function formatPrice(price) {
            const numericPrice = parseFloat(price);
            if (isNaN(numericPrice)) {
                return '0,00';
            }
            return new Intl.NumberFormat('tr-TR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(numericPrice);
        }
        
        /**
         * Ekranda kısa süreli bir bildirim mesajı gösterir (Yeni Stil)
         */
        function showToast(message) {
            toastMessage.innerText = message;
            toast.classList.remove('opacity-0', 'translate-x-full');
            toast.classList.add('opacity-100', 'translate-x-0');
            
            setTimeout(() => {
                toast.classList.remove('opacity-100', 'translate-x-0');
                toast.classList.add('opacity-0', 'translate-x-full');
            }, 3000);
        }

    </script>

</body>
</html>
